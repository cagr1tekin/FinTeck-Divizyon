@page
@model InteraktifKredi.Pages.KrediRehberi.IndexModel
@{
    ViewData["Title"] = "Kredi Rehberi";
}

<div class="blog_list_container">
    <div class="blog_list__main">
        <div class="blog_list__items">
            @foreach (var post in Model.FeaturedPosts)
            {
                <article class="blog_featured">
                    @if (post == Model.FeaturedPosts.First())
                    {
                        <div class="blog_featured__badge">Yeni Yazı</div>
                    }
                    <div class="blog_featured__image">
                        <img src="@post.ImageUrl" alt="@post.Title" />
                    </div>
                    <div class="blog_featured__content">
                        <h1 class="blog_featured__title">
                            <a href="/KrediRehberi/@post.Slug">@post.Title</a>
                        </h1>
                        <p class="blog_featured__excerpt">@post.Excerpt</p>
                        <div class="blog_featured__meta">
                            <span class="blog_featured__author">@post.Author</span>
                            <span class="blog_featured__date">@GetTimeAgo(post.PublishedDate)</span>
                        </div>
                    </div>
                </article>
            }
        </div>
    </div>

    <aside class="blog_list__sidebar">
        <div class="blog_most_read">
            <h2 class="blog_most_read__title">EN ÇOK OKUNANLAR</h2>
            <ul class="blog_most_read__list">
                @foreach (var post in Model.MostReadPosts)
                {
                    <li class="blog_most_read__item">
                        <a href="/KrediRehberi/@post.Slug" class="blog_most_read__link">
                            <h3 class="blog_most_read__item_title">@post.Title</h3>
                            <div class="blog_most_read__item_meta">
                                <span class="blog_most_read__item_author">@post.Author</span>
                                <span class="blog_most_read__item_date">@GetTimeAgo(post.PublishedDate)</span>
                            </div>
                        </a>
                    </li>
                }
            </ul>
        </div>
    </aside>
</div>

@functions {
    private string GetTimeAgo(DateTime date)
    {
        var timeSpan = DateTime.Now - date;
        
        if (timeSpan.Days == 0)
            return "Bugün";
        else if (timeSpan.Days == 1)
            return "1 Gün Önce";
        else if (timeSpan.Days < 7)
            return $"{timeSpan.Days} Gün Önce";
        else if (timeSpan.Days < 30)
            return $"{timeSpan.Days / 7} Hafta Önce";
        else if (timeSpan.Days < 365)
            return $"{timeSpan.Days / 30} Ay Önce";
        else
            return $"{timeSpan.Days / 365} Yıl Önce";
    }
}

